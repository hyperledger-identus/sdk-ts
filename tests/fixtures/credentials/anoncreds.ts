import type * as Anoncreds from "anoncreds-browser";

import { AttachmentDescriptor, LinkSecret } from "../../../src/domain";
import { ProtocolType } from "../../../src/edge-agent/protocols/ProtocolTypes";
import { OfferCredential } from "../../../src/edge-agent/protocols/issueCredential/OfferCredential";
import { list } from "../dids";

export const credDefId = "did:web:xyz/resource/definition";
export const schemaId = "did:web:xyz/resource/schema";

export const linkSecret = new LinkSecret("45165664483081773963604376644380612408785244477776600146144631718778586129454");

export const schema: Anoncreds.CredentialSchemaType = {
  name: "schema name",
  version: "1.0",
  attrNames: ["name", "age"],
  issuerId: "did:web:xyz",
};

export const schemas = { [schemaId]: schema };

export const credentialDefinitionPrivate: Anoncreds.CredentialDefinitionPrivateType = {
  "value": {
    "p_key": {
      "p": "61276330880857218809910740660662666563247882830222785648742854407304405696593770445964387962986651455056324949855177440639764987586477797961591580548984996736679761902248026003331444704702972533343581307548748305490540572635023137653209507460440105398649589102118767601074200102543148757726299688094946629549",
      "q": "26952357855775956981139659193170191078672912010075303237208621083094753060340671224612971837528763385282519937660099811223044704714107999185043745384485627385150192545162927597399210561378963528456097899510976637109895478728363001224181590526080736231882405193729988671212900706506436140073826475191907855551"
    }
  }
}

export const credentialDefinition: Anoncreds.CredentialDefinitionType = {
  "schemaId": "did:web:xyz/resource/schema",
  "type": "CL",
  "tag": "any",
  "value": {
    "primary": {
      "n": "6606166391959195709001505376101296980122678361504880918006828136828871155174678935013998958769868401626198573242872289486511699320930863472325117355659870128145919293034443387431071840573761880726314492820347565192910572715524444251523400642082803372584098957122764479442204421357658474624528663591530834623316801912905047244978434823009953417228137613932238157585326253943714113816388254654861157162548126304415951319500775424738440702616784645748887718700981492020468795150115889258298527095656776259934183665257113006696408161813964123571573300165097453500922814182040537582946147525693936073179780052748910076197",
      "s": "524663960937095092501381438596588141818288997142100772268942874454243558854158429490330241423298188720455393849388953356162153272268926957719526658170078802291748298075890972944586090012022265163910493411746810500234626244255466653077265920854406691190578790990593421234962443171950700454980289573288367807561993562718511579876522273874848399658808786599222645821903743232350672238383127127775271681463980308942064690408445838573493954114751605118377361710648477078854235814697100325609058745378721173176142536316076354304404909246068499769599635664928258040524714729151680842777473594985990880749893105173338972066",
      "r": {
        "age": "1233720795461932304875496351155925104181352958284740810223382128254226351697966683932741929312553473132306980629566205523795604334243277920466477446032834035648436819450189424124084608197327345709469640759513829283856852271556550799532318646875860889943921046113987354957528519256946200089306414889960440147070113759762454022825106984960349813592516541138868322286838676190043096159239216160424616761740864060908158467571926797449190508353882633375015609570062005648735634889863064360496651294255225156623618618823539207674383469174391383592129334091985764043382427014769606259437478363780718492096480109884428288172",
        "name": "5070768034697670456081599032362537077366596586510275936545002501124383409211359604075006078999499175679378698372216335530863076051238871687302302725613090050510423122412674686407494809322544508527934772800616969314199518172549119633617324535108922243310626674854348187502793826665462851913041209048642778396164002433066121854515340584541785747355844155472853138681075948309503056771733330760818329866329365438862241536237715181334953925265440625294392952320766686669349611518154244436000685416521075217102946147226106908118977040069179510483625106335073056184936189821783281699619346790456966714796758764749305944871",
        "master_secret": "6159049354048192306341834688023662690179427499620529590248932862576779840880546141800977661593803380827323685012096823550304865796787225752054763290657699895647825112985348509153636301840078125969914453952733274531236056621912246015503112585693695269278560891212949426891641192876553818813069193281499256357365795869589893750990447222423937739695942621047390127217931542271886912267422268710164260820267976498796698910849492685270641352936494630812796058666695962290706861027782186906400021025388579566635077704520396065055168804132568433222816867475245967176303061237155249618350531223014697368897116103124567730496"
      },
      "rctxt": "3808203674702844456483439191644370881693301913325715744469505894420754266583597445651898821586571290020511851807837948201065438435012239720100698399316599393620436389323692142505453338528609855367309142075178142651599575540187068057259300919313771561364208927623705116312571122306928790661719666119310657129750675617857278739647709383210158347895126360271135916749604918827814611679908271120294163375382494926008308509691013962151771757610079047096092132563528984214594789963239301282869546825414616494054627269201331784455707863572867908880816153702077817697837614805949926701083307253111893847933607985130221066819",
      "z": "4516520977580274536110668143210312777656890542489864759189519100125525526182686751338482408072570795025569069133149574222672377688092056750223166206684372770219173964453166648319662053225808292560474860156409994921373471445369577447560763041992106169880533177733270203081891266883511440324699966924011233934248670934796213280684130991405318538335113243693851025589932086197363933555674647228964715999865600768442387758372715067912037581551721719752509888235910854451629535203852475720608677069955608016446264533064180546625520161935988419610723078501897662022272670371863030059763505505708228171316436224752387648805"
    }
  },
  "issuerId": "did:web:xyz"
};

export const credentialKeyCorrectnessProof: Anoncreds.CredentialKeyCorrectnessProofType = {
  "c": "111324886206001186941672652228402086027151936697966829567235237481765475252449",
  "xz_cap": "111189632240682066476847410563967694406778298368491292406574509639586878920890221099400978974097672756489958639354788841054940357416863235580465218093511442376677253402493494929031029643416653059305247523358249905849183780837418583391025628376187802462750722046316842430824436094666264676791986915533381960142777654043740945163887462199168472675212146509229966173965630216770649682463392366396706218881303809482734504576764794797983413323351214235374011592351525636813052040420755342600738224609464633339877316561544992302386491118718783653616621254814673142389215856794775967843596339552763843984389629851905801925475630735929218316034734336031163023023588077837253082892368589278480199177392",
  "xr_cap": [
    [
      "age",
      "9439558545702871013042377100084934121791635560524010036129629522620496909115684733498730737127794762533833937870962594589639163324874654833715027124549697006032922472706210649861011768326632945144231622740285841558063948576157897737245060181272418867587319534388952184637182744189201106906689613083873033203606081006597478358590220700519575054273251835531713810643379691561080995870044548919721459751108848630500456942319334979196351073874130398721717522603862804659790799923904278876514440862458824648437103203470341258940733177416834735892605578712114149458812433369028867496446260860051900511788848154286772505160908717425317713760087955562759295199822022039555777923990775013823501899916"
    ],
    [
      "master_secret",
      "98765298591366362909919150855930156883584465786751830851180511197962272594961053770729621760585254994639828711422247836101639545006271404363999714672871932033804599166926831083251342444479398019923176725766081059042205454084204766117340707507243338777504879199522495409765623891150361704528113043781327098873975611819232681166719907901549436829768388123064123009176448511772975674397063965940754430669861528365445979661416788244986193657541408607192116485982728492968315814425972500127779758266199846647631447558734160692205328354323314811368988036278442508571773724087520949261880170831909735758172302662205412862048672807576909260072094625706193020192562709783638127453571866386051710731276"
    ],
    [
      "name",
      "106535569995754152544135869745416133023228408332653085853494443939755651880479540360905022315607678028918198245826288218189839618024587118464657342716571645598903227701348333174808844175625016824720225811659721427539481563249452998628427768831586924048052681972528507725047575892510218450302378323100865201545982611742574463040199348667023222943308630501358304720904448369533580712111964427307536399741269205034637277623016221082146552045687050000775789901422040623800343971431792317251824339748614030087091505697832608277968435971692280134638285030364376297958619037881089307252883080290946232139253677852722180942721294617349610465961587798362442641695580863491417296739241416695049668253075"
    ]
  ]
}

export const credDefs = { [credDefId]: credentialDefinition };

export const credentialOffer: Anoncreds.CredentialOfferType = {
  "schema_id": "did:web:xyz/resource/schema",
  "cred_def_id": "did:web:xyz/resource/definition",
  "key_correctness_proof": {
    "c": "111324886206001186941672652228402086027151936697966829567235237481765475252449",
    "xz_cap": "111189632240682066476847410563967694406778298368491292406574509639586878920890221099400978974097672756489958639354788841054940357416863235580465218093511442376677253402493494929031029643416653059305247523358249905849183780837418583391025628376187802462750722046316842430824436094666264676791986915533381960142777654043740945163887462199168472675212146509229966173965630216770649682463392366396706218881303809482734504576764794797983413323351214235374011592351525636813052040420755342600738224609464633339877316561544992302386491118718783653616621254814673142389215856794775967843596339552763843984389629851905801925475630735929218316034734336031163023023588077837253082892368589278480199177392",
    "xr_cap": [
      [
        "age",
        "9439558545702871013042377100084934121791635560524010036129629522620496909115684733498730737127794762533833937870962594589639163324874654833715027124549697006032922472706210649861011768326632945144231622740285841558063948576157897737245060181272418867587319534388952184637182744189201106906689613083873033203606081006597478358590220700519575054273251835531713810643379691561080995870044548919721459751108848630500456942319334979196351073874130398721717522603862804659790799923904278876514440862458824648437103203470341258940733177416834735892605578712114149458812433369028867496446260860051900511788848154286772505160908717425317713760087955562759295199822022039555777923990775013823501899916"
      ],
      [
        "master_secret",
        "98765298591366362909919150855930156883584465786751830851180511197962272594961053770729621760585254994639828711422247836101639545006271404363999714672871932033804599166926831083251342444479398019923176725766081059042205454084204766117340707507243338777504879199522495409765623891150361704528113043781327098873975611819232681166719907901549436829768388123064123009176448511772975674397063965940754430669861528365445979661416788244986193657541408607192116485982728492968315814425972500127779758266199846647631447558734160692205328354323314811368988036278442508571773724087520949261880170831909735758172302662205412862048672807576909260072094625706193020192562709783638127453571866386051710731276"
      ],
      [
        "name",
        "106535569995754152544135869745416133023228408332653085853494443939755651880479540360905022315607678028918198245826288218189839618024587118464657342716571645598903227701348333174808844175625016824720225811659721427539481563249452998628427768831586924048052681972528507725047575892510218450302378323100865201545982611742574463040199348667023222943308630501358304720904448369533580712111964427307536399741269205034637277623016221082146552045687050000775789901422040623800343971431792317251824339748614030087091505697832608277968435971692280134638285030364376297958619037881089307252883080290946232139253677852722180942721294617349610465961587798362442641695580863491417296739241416695049668253075"
      ]
    ]
  },
  "nonce": "925653456414658749982289"
};

export const credentialOfferMessage = new OfferCredential(
  {
    "formats": [],
    "credential_preview": {
      "body": {
        "attributes": [
          {
            "media_type": null,
            "name": "familyName",
            "value": "Wonderland"
          },
        ]
      },
      "schema_id": schemaId,
      "type": ProtocolType.DidcommCredentialPreview
    },
    "comment": undefined
  } as any,
  [
    new AttachmentDescriptor({
      base64: Buffer.from(JSON.stringify(credentialOffer)).toString("base64")
    },
      undefined,
      "8356b08d-7505-4c6f-885b-b8a8997d0931",
      undefined,
      "anoncreds/credential-offer@v1.0"
    )
  ],
  list[2],
  list[3],
  "4195ffdf-6bdc-45b2-b149-0aa40575ece2",
  "4fd78c22-ec2a-4d64-9238-a96689fcd8c0"
);

export const credentialRequest: Anoncreds.CredentialRequestType = {
  "entropy": "730250021120741804015884",
  "cred_def_id": "did:web:xyz/resource/definition",
  "blinded_ms": {
    "u": "76144765557401808253773184171779080351674936364431066877257297381060582935968687454652089834249160581586024683660198735897107451220595265895375368745028967121789237645043009598542667971491416501339685259379690591005841141728820739091874440776068181222163142842946189885356361649336763131770347276126634679401092830372425341870580580623464905812744655680681420073170854546741932391023668671825724870305392997175550999445209405029445043096806918458349523630657827779082809694787630366872825909075133665863320208702980056964266632374209360596462039459927064750771122572950851371252826673092054165669447014161994336986",
    "hidden_attributes": [
      "master_secret"
    ],
    "committed_attributes": {}
  },
  "blinded_ms_correctness_proof": {
    "c": "56895799575898879561762334184229814956648879868719159321981698236911676811560",
    "v_dash_cap": "752909693143315722995112781816163907352670903596704585785464164597185209293362047372689228957111544304497769810375784793925447694190403577358648643449143394299223524837736813000473859730091804637381489208822295287482039505239750402915679217919685087732415921660805621397076856866012083482345487212479229845162983343162231993368805851082737158183500033057730528069984456983183102359339237615882354960234218776718763878745425909234917065484217521170616354255438700683765358026372788823333389469182026190520801829743637083903217339591678687329346013191335669107293807922050676670618058733433242939666200345426107849147228282877485292756003012982416346111171076238711606277034536172679055740028038790501246415967785263175",
    "m_caps": {
      "master_secret": "11169616787800079510705085518023523862915782475287127737562345838362700666207028592049026365923022199650744961748095295941305586926674036161258784534744467020018506993751497914996"
    },
    "r_caps": {}
  },
  "nonce": "1080668696329767153660855"
};

export const credentialRequestMeta: Anoncreds.CredentialRequestMetadataType = {
  "link_secret_blinding_data": {
    "v_prime": "13233133179522958308683907463568090338495901274351434819149471719094502086383850947532217606104076521072208664560596012390021122503508771723758028960241370575198315658357206890508089692242910352122688434429729935675619742700981868528135417086949306720532465032964996427553225398181821257259721026272193331750920778739560704964946729405015084852090560293468172395670913094210973740240429518096127581275015513939995507027810816162527913214235145551725026696915953548515343686558023525862042539125157999307278203377981342818077298243760652830948823081881323579344505105152681108072522680756130072778666264022445451129190227695093846756027192143"
  },
  "nonce": "1080668696329767153660855",
  "link_secret_name": "12345678654321"
};

export const credentialIssued: Anoncreds.CredentialType = {
  "schema_id": "did:web:xyz/resource/schema",
  "cred_def_id": "did:web:xyz/resource/definition",
  "values": {
    "age": {
      "raw": "20",
      "encoded": "20"
    },
    "name": {
      "raw": "test",
      "encoded": "72155939486846849509759369733266486982821795810448245423168957390607644363272"
    }
  },
  "signature": {
    "p_credential": {
      "m_2": "39702101542446551449599512570205753411910971587693193774973368496099338901770",
      "a": "2718470338205757926379713357116130132630608195848785532661868933235964178110376232347164346744724644524242121054948526425734089759584373025648813223749851859530038845351838506042168245505452036526834989207512156424940409624412038988799177223939012719509211520403483879871984121748219743484676789259064502319233012894588826890157557918401726579571185438078182335935119726229771173249334914111652166540255118320113166282542070431330561059636838167476574086959056139244841802400034024366008665053230092211444731035937616962893207367913786448204502631125912581277490325308715800990256310082092637475542478176267968761998",
      "e": "259344723055062059907025491480697571938277889515152306249728583105665800713306759149981690559193987143012367913206299323899696942213235956742929817700916329254685999530897448784179",
      "v": "8053975388528556509137929461840265504721640627001697506953780310691703021160834517825760183678531903159700443092251539816307634956871956159034730752279815062673592930821045420513913001068302847805831595783347349080204293172932223016362778694783408478282470110442423277695708801319757646121587083313642715384082630244911579354309988982541888961459074810380132374716860389364707939714944009928199436954986824139851990380536395874214934121865594099452519193363870023326088692249561571432538935621210063673998589060339307972572327785216933754718377239209239099019352537235031406765388281933899071428084718770969143404844747199313231367210476846134573888091768447506004920395099359668748459231185535963906050019436248702776866785327067752313070293450425693737187645991215075576930829850189976102809613193737026042396920858746"
    }
  },
  "signature_correctness_proof": {
    "se": "1411743568706134508853788979643844773973895975216868709067594405334807583171509653154230048241547301249613098585195981973836494218703449682100170020862717598441567466187710007619727788178738799457667290632443852484517221898504622514081721674267830730864164156444275723551498692255347088421033736945194391045725037426853689740889578404557440558006040713112471201427307176235498757574280802327895794421170193656901486779503771227387213874113021188740572820452083231107110323352743969300796132139334008742147578009466232756207318288737672859647405539518949180917788433818859905634734837464560465164762099094413530948374",
    "c": "63316290146843924303458233899031533139200861453278723311347288340447029667460"
  }
};

export const credential: Anoncreds.CredentialType = {
  "schema_id": "did:web:xyz/resource/schema",
  "cred_def_id": "did:web:xyz/resource/definition",
  "values": {
    "name": {
      "raw": "test",
      "encoded": "72155939486846849509759369733266486982821795810448245423168957390607644363272"
    },
    "age": {
      "raw": "20",
      "encoded": "20"
    }
  },
  "signature": {
    "p_credential": {
      "m_2": "39702101542446551449599512570205753411910971587693193774973368496099338901770",
      "a": "2718470338205757926379713357116130132630608195848785532661868933235964178110376232347164346744724644524242121054948526425734089759584373025648813223749851859530038845351838506042168245505452036526834989207512156424940409624412038988799177223939012719509211520403483879871984121748219743484676789259064502319233012894588826890157557918401726579571185438078182335935119726229771173249334914111652166540255118320113166282542070431330561059636838167476574086959056139244841802400034024366008665053230092211444731035937616962893207367913786448204502631125912581277490325308715800990256310082092637475542478176267968761998",
      "e": "259344723055062059907025491480697571938277889515152306249728583105665800713306759149981690559193987143012367913206299323899696942213235956742929817700916329254685999530897448784179",
      "v": "8053975388528556509137929461840265504721640627001697506953780310691703021160834517825760183678531903159700443092251539816307634956871956159034730752279815062673592930821045420513926234201482370764140279690810917170542789074206574451181928166502502980368853961389955495301812877840829854786147679326032736506586139016635337383270230353117087277117432017270640464409103299716830628149373739863875056697687806008380125797623345180935466586898559095880072418762051844583348413275833764764289856399949624378963535789744323057424418345510401927114048152303450072759592966753127534346663297447839066935112529587131671318058982344864956393907392799683089231778326471031866962934224517668055737434563517306724127317680009355607815608408949075892414798555578374845260168671971205649709496114212421553938803421432119889152948050889"
    }
  },
  "signature_correctness_proof": {
    "se": "1411743568706134508853788979643844773973895975216868709067594405334807583171509653154230048241547301249613098585195981973836494218703449682100170020862717598441567466187710007619727788178738799457667290632443852484517221898504622514081721674267830730864164156444275723551498692255347088421033736945194391045725037426853689740889578404557440558006040713112471201427307176235498757574280802327895794421170193656901486779503771227387213874113021188740572820452083231107110323352743969300796132139334008742147578009466232756207318288737672859647405539518949180917788433818859905634734837464560465164762099094413530948374",
    "c": "63316290146843924303458233899031533139200861453278723311347288340447029667460"
  }
};

export const presentationRequest: Anoncreds.PresentationRequestType = {
  "name": "example",
  "nonce": "713674866223395004807278",
  "requested_attributes": {
    "name1": {
      "name": "name",
      "restrictions": {
        "cred_def_id": "did:web:xyz/resource/definition"
      }
    }
  },
  "requested_predicates": {
    "age1": {
      "name": "age",
      "p_type": ">=",
      "p_value": 18
    }
  },
  "version": "0.1"
};
